exports.InsertImagePlugin=function(e){var t={};function i(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(r,o,function(t){return e[t]}.bind(null,o));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=19)}([function(e,t){e.exports=require("@ckeditor/ckeditor5-core/src/plugin")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/button/buttonview")},function(e,t){e.exports=require("@ckeditor/ckeditor5-image/src/image/utils")},function(e,t){e.exports=require("@ckeditor/ckeditor5-image/src/image")},function(e,t){e.exports=require("@ckeditor/ckeditor5-core/src/command")},function(e,t){e.exports=require("@ckeditor/ckeditor5-core/theme/icons/image.svg")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/bindings/clickoutsidehandler")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/panel/balloon/balloonpanelview")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/panel/balloon/contextualballoon")},function(e,t){e.exports=require("@ckeditor/ckeditor5-core/theme/icons/cancel.svg")},function(e,t){e.exports=require("@ckeditor/ckeditor5-core/theme/icons/check.svg")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/bindings/submithandler")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/focuscycler")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/inputtext/inputtextview")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/labeledinput/labeledinputview")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/view")},function(e,t){e.exports=require("@ckeditor/ckeditor5-ui/src/viewcollection")},function(e,t){e.exports=require("@ckeditor/ckeditor5-utils/src/focustracker")},function(e,t){e.exports=require("@ckeditor/ckeditor5-utils/src/keystrokehandler")},function(e,t,i){"use strict";i.r(t);var r=i(3),o=i.n(r),n=i(0),s=i.n(n),c=i(4),a=i.n(c),u=i(2);const l=e=>{return e.lastIndexOf("?")>-1?e.slice(0,e.lastIndexOf("?")):e},d=e=>/\.(jpeg|jpg|gif|png)$/.test(e);class h extends a.a{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e){const t=l(e);d(t)?this._insertImage(t):alert("Don`t do that!")}_getValue(){const e=this.editor.model.document.selection.getSelectedElement();return Object(u.isImage)(e)?e.getAttribute("src"):""}_checkEnabled(){const e=this.editor.model.document.selection.getSelectedElement();return!Object(u.isImage)(e)}_insertImage(e){const{model:t}=this.editor;t.change(i=>{const r=i.createElement("image",{src:e});t.insertContent(r,t.document.selection)})}}class m extends s.a{init(){this.editor.commands.add("insertImage",new h(this.editor))}}var f=i(5),b=i.n(f),p=i(6),k=i.n(p),g=i(1),x=i.n(g),v=i(7),_=i.n(v),w=i(8),I=i.n(w),y=i(9),q=i.n(y),E=i(10),B=i.n(E),V=i(11),O=i.n(V),T=i(12),j=i.n(T),S=i(13),F=i.n(S),P=i(14),A=i.n(P),N=i(15),M=i.n(N),C=i(16),D=i.n(C),L=i(17),W=i.n(L),H=i(18),$=i.n(H);class z extends M.a{constructor(e){super(e),this.labeledInput=this._createLabeledInputView(),this.saveButton=this._createButton(this.t("Save"),B.a,"ck-button-save"),this.saveButton.type="submit",this.cancelButton=this._createButton(this.t("Cancel"),q.a,"ck-button-cancel"),this.focusTracker=new W.a,this.keystrokes=new $.a,this._focusables=new D.a,this._focusCycler=new j.a({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.cancelButton.delegate("execute").to(this,"cancel"),this.keystrokes.set("Esc",()=>{this.fire("cancel")}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-insert-image-form"]},children:[this.labeledInput,this.saveButton,this.cancelButton]})}render(){super.render(),this.keystrokes.listenTo(this.element),O()({view:this}),[this.labeledInput,this.saveButton,this.cancelButton].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)})}_createButton(e,t,i){const r=new x.a(this.locale);return r.set({label:e,icon:t,tooltip:!0}),r.extendTemplate({attributes:{class:i}}),r}_createLabeledInputView(){const e=new A.a(this.locale,F.a);return e.label=this.t("Insert image url"),e.inputView.placeholder=this.t("Insert image url"),e}}class G extends s.a{init(){this.balloon=this.editor.plugins.get(I.a),this.button=this._createButton(),this.form=this._createForm(),this.attachEvents()}get _isVisible(){return this.balloon.visibleView===this.form}attachEvents(){const e=this.editor.commands.get("insertImage");this.listenTo(e,"change:isEnabled",(e,t,i)=>{i||this._hideForm()}),this.listenTo(this.button,"execute",()=>this._showForm()),this.listenTo(this.form,"cancel",()=>{this._hideForm(),this.editor.editing.view.focus()}),this.listenTo(this.form,"submit",()=>{this.editor.execute("insertImage",this.form.labeledInput.inputView.element.value),this._hideForm(),this.editor.editing.view.focus()}),k()({emitter:this.form,activator:()=>this._isVisible,contextElements:[this.form.element,this.button.element],callback:()=>this._hideForm()})}_createButton(){const e=this.editor,t=e.commands.get("insertImage"),i=new x.a(e.locale);return i.set({label:e.t("Insert image"),icon:b.a}),i.bind("isEnabled").to(t,"isEnabled"),i.bind("isOn").to(this.balloon.view,"isVisible"),i.bind("tooltip").to(i,"isOn",e=>!e),i.render(),e.ui.componentFactory.add("insertImage",()=>this.button),i}_createForm(){const e=new z(this.editor.locale);return e.render(),e}_showForm(){this._isVisible?this.form.labeledInput.focus():(this.balloon.hasView(this.form)||this.balloon.add({view:this.form,position:this._getBalloonPositionData()}),this.form.labeledInput.focus())}_hideForm(){this._isVisible&&(this.form.labeledInput.inputView.element.value="",this.balloon.remove(this.form))}_getBalloonPositionData(){const{defaultPositions:e}=_.a;return{target:this.button.element,positions:[e.northArrowSouth,e.northArrowSouthWest,e.northArrowSouthEast,e.southArrowNorth,e.southArrowNorthWest,e.southArrowNorthEast]}}}i.d(t,"InsertImage",function(){return J});class J extends o.a{static get pluginName(){return"InsertImage"}static get requires(){return[m,G]}}}]).default;
//# sourceMappingURL=insertimage.js.map